---
export const prerender = false;

import K8sCheatsheetCTA from "./K8sCheatsheetCTA.vue";

interface Props {
	class?: string;
}

const { class: className } = Astro.props;

const user = Astro.locals.user;
const pagePath = Astro.url.pathname;
const signInUrl = `/sign-in?returnTo=${encodeURIComponent(pagePath)}`;

// Check for the cheatsheet download cookie (server-side)
const hasCheatsheetCookie =
	Astro.cookies.get("lead-magnet:k8s-1-35-cheatsheet")?.value === "true";

// For anonymous users who already downloaded, we still show it but the component handles the state
---

<section class:list={["w-full", className]}>
	<div class="mx-auto max-w-7xl">
		<K8sCheatsheetCTA
			client:visible
			isSignedIn={!!user}
			isSubscribed={hasCheatsheetCookie}
			signInUrl={signInUrl}
			pagePath={pagePath}
		/>
	</div>
</section>
