---
import AppShell from "@/components/layout/AppShell.astro";
import BaseLayout from "@/layouts/BaseLayout.astro";
import { buttonPrimarySmClass } from "@/lib/ui-classes";
import { getSessionWithPermissions } from "@/lib/server/session";
import type { TypedEnv } from "@/types/service-bindings";

const env = Astro.locals.runtime.env as TypedEnv;
const { session, permissions } = await getSessionWithPermissions(env, Astro.cookies);
---

<BaseLayout
  title="Page unavailable | Rawkode News"
  description="This page is not available right now. Explore the latest posts on Rawkode News."
  robots="noindex, nofollow"
  ogType="website"
>
  <AppShell
    pathname={Astro.url.pathname}
    search={Astro.url.search}
    user={session?.user ?? null}
    isAdmin={Boolean(permissions?.isAdmin)}
  >
    <main class="py-7">
      <section class="rkn-panel space-y-5 p-6 sm:p-7">
        <div class="space-y-2">
          <p class="rkn-kicker">Page unavailable</p>
          <h1 class="rkn-page-title">We couldn't find that page</h1>
          <p class="text-sm text-muted-foreground">The link may be outdated, or the page may have moved.</p>
        </div>

        <p class="break-all font-mono text-xs text-muted-foreground">Requested path: {Astro.url.pathname}</p>

        <div class="flex flex-wrap items-center gap-2">
          <a
            href="/"
            class={buttonPrimarySmClass}
          >
            Go to latest posts
          </a>
        </div>
      </section>
    </main>
  </AppShell>
</BaseLayout>
