# Repository Guidelines

## Project Structure & Module Organization
- `src/pages/` holds Astro routes. `src/pages/index.astro` mounts the React app.
- `src/components/app.tsx` is the main React Router application shell and views.
- `src/components/ui/` contains shadcn UI components generated by the CLI.
- `src/db/` holds the Drizzle schema and database helper.
- `src/lib/utils.ts` provides shared helpers (e.g., `cn`).
- `src/styles/global.css` contains Tailwind v4 setup and theme tokens.
- `drizzle/` stores SQL migrations generated by drizzle-kit.
- `public/` stores static assets served as-is.
- `wrangler.jsonc` configures Cloudflare Workers/D1/KV.
- `env.cue` defines cuenv task wrappers.

## Build, Test, and Development Commands
Run all commands from repo root.
- `cuenv t dev` starts the Astro dev server.
- `cuenv t build` builds the production bundle into `dist/`.
Always run `cuenv t build` after implementing a feature and note the result in your PR or update summary.

## Coding Style & Naming Conventions
- Use TypeScript/TSX for React code and `.astro` for pages.
- Follow existing formatting in each file (2-space indent, double quotes common).
- Keep Tailwind class lists readable; avoid reformatting shadcn-generated files.
- Prefer descriptive component names and lowercase story/comment content where already used.

## Testing Guidelines
No test framework is configured yet. If you add tests:
- Place files under `src/` with names like `*.test.ts` or `*.test.tsx`.
- Add a test script to `package.json` and document the runner you chose.

## Commit & Pull Request Guidelines
Commit messages follow Conventional Commits (e.g., `feat:`, `fix:`, `chore:`, `style:`, `ci:`).
When amending or creating commit bodies, do not include literal `\n` sequences; use multiple `-m` flags or a heredoc (`git commit -F - <<'EOF' ... EOF`) so newlines render correctly.
PRs should include:
- A brief summary of changes and affected routes/components.
- Screenshots or screen recordings for UI updates.
- Notes on config changes (e.g., `wrangler.jsonc`, `components.json`, `env.cue`).

## Tooling Notes
- Use the Astro CLI for integrations: `bunx astro add <integration>`.
- Use the shadcn CLI for UI components: `bunx shadcn@latest add <component>`.
- Use `bunx drizzle-kit generate` to create D1 migrations from `src/db/schema.ts`.
